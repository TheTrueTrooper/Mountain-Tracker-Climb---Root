
@{
    ViewBag.Title = "DirectMessage";
}
<script src="~/Scripts/AngularJSMessages.js"></script>
<div ng-app="NGMessages" ng-controller="DirectMessagesController">
    <h2>Conversation with - {{DirectMessages.User.UserName}}</h2>
    <input type="hidden" class="input-lg" ng-init="Init(@Session[Mountain_Tracker_Climb___API.App_Start.StaticVars.UserID], @ViewBag.OtherUserID)" ng-model="SearchingName" ng-change="SearchName()">
    <div id="MessageScrollBox" style="background-color:lightgray;border-radius:20px;height:500px;overflow-y:scroll">
        <div ng-repeat="Message in DirectMessages.AllMessages  | orderBy:'-Time':true">
            <div ng-if="Message.UserFromID===DirectMessages.User.ID" style="padding:10px">
                <div class="media-left">
                    <img ng-src="{{DirectMessages.User.ProfilePicture}}" class="img-rounded media-object" style="width:100px;height:100px;border-radius:50%;border:inset">
                </div>
                <div class="media-body" style="background-color:lightblue;border-radius:20px;padding:20px">
                    <h4 ng-if="Message.Seen" class="media-heading">{{DirectMessages.User.UserName}}</h4>
                    <h4 ng-if="!Message.Seen" class="media-heading">{{DirectMessages.User.UserName}} - Unread Message!</h4>
                    <p>
                        {{Message.Time.toUTCString()}}<br />
                        {{Message.Message}}
                    </p>
                </div>
            </div>
            <div ng-if="!(Message.UserFromID===DirectMessages.User.ID)" style="padding:10px">
                <div class="media-body" style="background-color:lavender;border-radius:20px;padding:20px">
                    <h4 class="media-heading">{{User.UserName}}</h4>
                    <p>
                        {{Message.Time.toUTCString()}}<br />
                        {{Message.Message}}
                    </p>
                </div>
                <div class="media-right">
                    <img ng-src="{{User.ProfilePicture}}" class="img-rounded media-object" style="width:100px;height:100px;border-radius:50%;border:inset">
                </div>
            </div>
        </div>
    </div>
    <div style="border-radius:20px;max-height:20%;padding:20px">
        <div>
            <textarea oninput="angular.element(this).scope().OnNewMessageChange()"  maxlength="2500" id="NewMessageBox" style="resize:none;width:100%;height:30%;max-height:30%;max-width:100%;border-radius:20px;max-height:20%"></textarea>
        </div>
        <input id="NewMessageButton" disabled type="button" class="btn btn-default" value="Send Message" ng-click="SendNewMessage()"/>
    </div>
</div>

